name: deploy

# 代码提交到main分支时触发github action
on:
  push:
    branches:
      - master

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      - name : setup Hugo
        uses: peaceiris/actions-hugo@v3
        with:
          hugo-version: "latest"
          extended: true
      - name : Build web
        run: hugo -D
      - name : Deploy web
        uses: peaceiris/actions-gh-pages@v4
        with:
          PERSONAL_TOKEN: ${{secrets.TOKEN}}
          EXTERNAL_REPOSITORY : mikey-666/blog
          PUBLISH_BRANCH: master
          PUBLISH_DIR: ./public
          commit_message: auto deploy
